{"ast":null,"code":"import _defineProperty2 from \"@babel/runtime/helpers/defineProperty\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty2(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}\nimport { isFunction, isOneOf } from \"../common\";\nimport { NativeError } from \"../internal/NativeError\";\nimport { AdEventType } from \"../AdEventType\";\nimport { RewardedAdEventType } from \"../RewardedAdEventType\";\nimport { GAMAdEventType } from \"../GAMAdEventType\";\nimport { validateAdShowOptions } from \"../validateAdShowOptions\";\nexport var MobileAd = function () {\n  function MobileAd(type, googleMobileAds, requestId, adUnitId, requestOptions) {\n    var _this = this;\n    _classCallCheck(this, MobileAd);\n    _defineProperty(this, \"_type\", void 0);\n    _defineProperty(this, \"_googleMobileAds\", void 0);\n    _defineProperty(this, \"_requestId\", void 0);\n    _defineProperty(this, \"_adUnitId\", void 0);\n    _defineProperty(this, \"_requestOptions\", void 0);\n    _defineProperty(this, \"_loaded\", void 0);\n    _defineProperty(this, \"_isLoadCalled\", void 0);\n    _defineProperty(this, \"_adEventsListeners\", void 0);\n    _defineProperty(this, \"_adEventListenersMap\", void 0);\n    _defineProperty(this, \"_adEventsListenerId\", void 0);\n    _defineProperty(this, \"_adEventListenerId\", void 0);\n    _defineProperty(this, \"_nativeListener\", void 0);\n    this._type = type;\n    this._googleMobileAds = googleMobileAds;\n    this._requestId = requestId;\n    this._adUnitId = adUnitId;\n    this._requestOptions = requestOptions;\n    this._loaded = false;\n    this._isLoadCalled = false;\n    this._adEventsListeners = new Map();\n    this._adEventListenersMap = new Map();\n    Object.values(_objectSpread(_objectSpread(_objectSpread(_objectSpread({}, AdEventType), RewardedAdEventType), GAMAdEventType), {}, {\n      _: AdEventType.LOADED\n    })).forEach(function (type) {\n      _this._adEventListenersMap.set(type, new Map());\n    });\n    this._adEventListenerId = 0;\n    this._adEventsListenerId = 0;\n    this._nativeListener = googleMobileAds.emitter.addListener(\"google_mobile_ads_\" + type + \"_event:\" + adUnitId + \":\" + requestId, this._handleAdEvent.bind(this));\n  }\n  _createClass(MobileAd, [{\n    key: \"_handleAdEvent\",\n    value: function _handleAdEvent(event) {\n      var _event$body = event.body,\n        type = _event$body.type,\n        error = _event$body.error,\n        data = _event$body.data;\n      if (type === AdEventType.LOADED || type === RewardedAdEventType.LOADED) {\n        this._loaded = true;\n      }\n      if (type === AdEventType.CLOSED) {\n        this._loaded = false;\n        this._isLoadCalled = false;\n      }\n      if (type === AdEventType.ERROR) {\n        this._loaded = false;\n        this._isLoadCalled = false;\n      }\n      var payload = data;\n      if (error) {\n        payload = NativeError.fromEvent(error, 'googleMobileAds');\n      }\n      this._adEventsListeners.forEach(function (listener) {\n        listener({\n          type: type,\n          payload: payload\n        });\n      });\n      this._getAdEventListeners(type).forEach(function (listener) {\n        listener(payload);\n      });\n    }\n  }, {\n    key: \"_addAdEventsListener\",\n    value: function _addAdEventsListener(listener) {\n      var _this2 = this;\n      if (!isFunction(listener)) {\n        throw new Error(this._className + \".addAdEventsListener(*) 'listener' expected a function.\");\n      }\n      var id = this._adEventsListenerId++;\n      this._adEventsListeners.set(id, listener);\n      return function () {\n        _this2._adEventsListeners.delete(id);\n      };\n    }\n  }, {\n    key: \"_addAdEventListener\",\n    value: function _addAdEventListener(type, listener) {\n      var _this3 = this;\n      if (!(isOneOf(type, Object.values(AdEventType)) || isOneOf(type, Object.values(RewardedAdEventType)) && (this._type === 'rewarded' || this._type === 'rewarded_interstitial'))) {\n        throw new Error(this._className + \".addAdEventListener(*) 'type' expected a valid event type value.\");\n      }\n      if (!isFunction(listener)) {\n        throw new Error(this._className + \".addAdEventListener(_, *) 'listener' expected a function.\");\n      }\n      var id = this._adEventListenerId++;\n      this._getAdEventListeners(type).set(id, listener);\n      return function () {\n        _this3._getAdEventListeners(type).delete(id);\n      };\n    }\n  }, {\n    key: \"_getAdEventListeners\",\n    value: function _getAdEventListeners(type) {\n      return this._adEventListenersMap.get(type);\n    }\n  }, {\n    key: \"_className\",\n    get: function get() {\n      return this.constructor.name;\n    }\n  }, {\n    key: \"_camelCaseType\",\n    get: function get() {\n      var type;\n      if (this._type === 'app_open') {\n        type = 'appOpen';\n      } else if (this._type === 'rewarded_interstitial') {\n        type = 'rewardedInterstitial';\n      } else {\n        type = this._type;\n      }\n      return type;\n    }\n  }, {\n    key: \"load\",\n    value: function load() {\n      if (this._loaded || this._isLoadCalled) {\n        return;\n      }\n      this._isLoadCalled = true;\n      var load = this._googleMobileAds.native[this._camelCaseType + \"Load\"];\n      load(this._requestId, this._adUnitId, this._requestOptions);\n    }\n  }, {\n    key: \"show\",\n    value: function show(showOptions) {\n      if (!this._loaded) {\n        throw new Error(this._className + \".show() The requested \" + this._className + \" has not loaded and could not be shown.\");\n      }\n      var options;\n      try {\n        options = validateAdShowOptions(showOptions);\n      } catch (e) {\n        if (e instanceof Error) {\n          throw new Error(this._className + \".show(*) \" + e.message + \".\");\n        } else {\n          throw e;\n        }\n      }\n      var show = this._googleMobileAds.native[this._camelCaseType + \"Show\"];\n      return show(this._requestId, this._adUnitId, options);\n    }\n  }, {\n    key: \"removeAllListeners\",\n    value: function removeAllListeners() {\n      this._adEventsListeners.clear();\n      this._adEventListenersMap.forEach(function (_, type, map) {\n        map.set(type, new Map());\n      });\n    }\n  }, {\n    key: \"adUnitId\",\n    get: function get() {\n      return this._adUnitId;\n    }\n  }, {\n    key: \"loaded\",\n    get: function get() {\n      return this._loaded;\n    }\n  }]);\n  return MobileAd;\n}();","map":{"version":3,"mappings":"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","names":["isFunction","isOneOf","NativeError","AdEventType","RewardedAdEventType","GAMAdEventType","validateAdShowOptions","MobileAd","constructor","type","googleMobileAds","requestId","adUnitId","requestOptions","_defineProperty","_type","_googleMobileAds","_requestId","_adUnitId","_requestOptions","_loaded","_isLoadCalled","_adEventsListeners","Map","_adEventListenersMap","Object","values","_","LOADED","forEach","set","_adEventListenerId","_adEventsListenerId","_nativeListener","emitter","addListener","_handleAdEvent","bind","event","body","error","data","CLOSED","ERROR","payload","fromEvent","listener","_getAdEventListeners","_addAdEventsListener","Error","_className","id","delete","_addAdEventListener","get","name","load","native","_camelCaseType","show","showOptions","options","e","message","removeAllListeners","clear","map"],"sources":["MobileAd.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module","externalDependencies":[]}